<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Biology arXiv Updates</title>

    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
    <link rel="icon" type="x-icon" href="/img/favicon.ico">

    <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/img/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/img/android-chrome-512x512.png">

    <link rel="manifest" href="/img/site.webmanifest">

    <meta name="theme-color" content="#ffffff">
    
    <link rel="stylesheet" href="style.css">

</head>
<body>
    <h1>Daily Biology arXiv Updates</h1>

    <p>Welcome to the Biology arXiv pages! This site crawls arXiv daily (primarily Biology), <br > and generates summaries for each paper, helping you stay updated on the latest research in Biology and Computer Science.</p>
    <p>Please note that the content may be delayed.</p>
    <p>Provide feedback on <a href="https://github.com/yukari502/yukari502.github.io" target="_blank" rel="noopener noreferrer">GitHub</a>.</p>

    <div id="quick-links-container"></div>
    
    <h2 class="history-title">Browse Full Archive</h2>

    <div id="updates-container">
        <div class="loading">少女祈禱中.....</div>
    </div>

    <hr class="footer-divider">

    <footer class="site-footer">
        <p>
            <a href="https://github.com/yukari502/yukari502.github.io" target="_blank" rel="noopener noreferrer">Source Code on GitHub</a>
        </p>
        <p>
            This project is licensed under the 
            <a href="https://www.gnu.org/licenses/gpl-3.0.en.html" target="_blank" rel="noopener noreferrer">GPL 3.0 License</a>.
        </p>
        <p class="disclaimer">
            <strong>Disclaimer:</strong> This is an automated, unofficial service. Summaries are generated by AI and may contain inaccuracies. 
            Always refer to the original papers on arXiv.org for authoritative information. This site is not affiliated with arXiv.
        </p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const updatesContainer = document.getElementById('updates-container');
            const quickLinksContainer = document.getElementById('quick-links-container');
            let allData = null; 
            let currentState = {};

            const monthNames = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];

            async function fetchUpdates() {
                try {
                    const response = await fetch('data/index.json');
                    if (!response.ok) throw new Error('Failed to fetch update list. Please refresh and try again.');
                    allData = await response.json();

                    if (!allData.filesByYear || Object.keys(allData.filesByYear).length === 0) {
                        updatesContainer.innerHTML = '<div class="error">No updates available.</div>';
                        return;
                    }
                    
                    createLatestArticleLink();
                    navigateTo({ level: 'years' });
                } catch (error) {
                    console.error('Error fetching updates:', error);
                    updatesContainer.innerHTML = `<div class="error">Failed to load updates: ${error.message}</div>`;
                }
            }

            function createLatestArticleLink() {
                const allFiles = Object.values(allData.filesByYear).flat();
                if (allFiles.length === 0) return;
                allFiles.sort((a, b) => new Date(b.date) - new Date(a.date));
                const latestFile = allFiles[0];

                const linkCard = document.createElement('a');
                linkCard.href = '#';
                linkCard.className = 'quick-link-card';
                linkCard.innerHTML = 'Bio arXiv Today <span class="arrow">→</span>';
                linkCard.dataset.path = latestFile.path;
                linkCard.dataset.dateStr = latestFile.date;
                quickLinksContainer.appendChild(linkCard);
            }
            
            function navigateTo(state) {
                currentState = state;
                renderCurrentView();
            }

            function renderCurrentView() {
                if (currentState.level === 'content') renderContentView();
                else renderListView();
            }

            function renderListView() {
                const { level, year, month } = currentState;
                let listHtml = '';
                
                if (level === 'years') listHtml = renderYearList(allData.filesByYear);
                else if (level === 'months') listHtml = renderMonthList(allData.filesByYear, year);
                else if (level === 'days') listHtml = renderDayList(allData.filesByYear, year, month);

                const containerClass = `item-list-container ${level}-view`;
                updatesContainer.innerHTML = `${renderBreadcrumbs()}<div class="${containerClass}">${listHtml}</div>`;
            }
            
            async function renderContentView() {
                updatesContainer.innerHTML = `${renderBreadcrumbs()}<div id="content-display"><div class="loading">少女祈禱中.....</div></div>`;
                try {
                    const response = await fetch(currentState.path);
                    if (!response.ok) throw new Error('Failed to load content.');
                    const markdown = await response.text();
                    const contentDiv = document.getElementById('content-display');
                    if (contentDiv) contentDiv.innerHTML = `<div class="markdown-content">${marked.parse(markdown)}</div>`;
                } catch (error) {
                    const contentDiv = document.getElementById('content-display');
                    if(contentDiv) contentDiv.innerHTML = `<div class="error">Failed to load content: ${error.message}</div>`;
                }
            }

            function renderBreadcrumbs() {
                const { level, year, month, dateStr } = currentState;
                let crumbs = `<a href="#" class="breadcrumb-item" data-level="years">Home</a>`;
                if (year) crumbs += `<span> / </span><a href="#" class="breadcrumb-item" data-level="months" data-year="${year}">${year}</a>`;
                if (month !== undefined && month !== null) crumbs += `<span> / </span><a href="#" class="breadcrumb-item" data-level="days" data-year="${year}" data-month="${month}">${monthNames[month]}</a>`;
                if (level === 'content' && dateStr) crumbs += `<span> / </span><span class="breadcrumb-current">${dateStr}</span>`;
                return `<nav class="breadcrumb-nav">${crumbs}</nav>`;
            }

            function renderYearList(filesByYear) {
                const years = Object.keys(filesByYear).sort((a, b) => b - a);
                return years.map(year => `<div class="list-item year-item" data-level="months" data-year="${year}">${year} <span class="arrow">→</span></div>`).join('');
            }

            function renderMonthList(filesByYear, year) {
                const files = filesByYear[year];
                const months = [...new Set(files.map(file => new Date(file.date).getMonth()))].sort((a, b) => b - a);
                return months.map(monthIndex => `<div class="list-item month-item" data-level="days" data-year="${year}" data-month="${monthIndex}">${monthNames[monthIndex]} <span class="arrow">→</span></div>`).join('');
            }

            function renderDayList(filesByYear, year, month) {
                const filesForMonth = filesByYear[year].filter(file => new Date(file.date).getMonth() == month).sort((a, b) => new Date(b.date) - new Date(a.date));
                return filesForMonth.map(file => `<div class="list-item day-item" data-path="${file.path}" data-date-str="${file.date}">${file.date} <span class="arrow">→</span></div>`).join('');
            }

            function attachEventListeners() {
                document.body.addEventListener('click', function(e) {
                    const target = e.target.closest('.list-item, .breadcrumb-item, .quick-link-card');
                    if (!target) return;
                    e.preventDefault();

                    if (target.classList.contains('quick-link-card') || target.classList.contains('day-item')) {
                        const { path, dateStr } = target.dataset;
                        const date = new Date(dateStr);
                        navigateTo({ level: 'content', year: date.getFullYear(), month: date.getMonth(), path: path, dateStr: dateStr });
                    } else {
                        const { level, year, month } = target.dataset;
                        navigateTo({ level: level, year: year, month: month });
                    }
                });
            }

            // Initialize the application
            fetchUpdates();
            attachEventListeners();
        });
    </script>
</body>
</html>